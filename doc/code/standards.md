Стандарты написания кода (Coding Standards)
=============

Для разработки качественных решений для UMI.CMS мы рекомендуем следовать стандартам написания кода, принятыми командой UMI.CMS.
Для быстрого и качественного старта, мы настоятельно рекомендуем использовать современную IDE (рекомендуем PHP Storm), выбрав в нем стандартную PSR схему.

Также для быстрого старта рекомендуется изучить уже существующий код UMI.CMS и следовать его стилю.

Придерживаться единых стандартов очень важно, так как это делает код любого разработчика частью единого целого, что значительно повышает качество и читаемость кода.

UMI.CMS полностью следует стандартам, принятыми в [PHP Framework Interop Group](http://www.php-fig.org/):

- [PSR-0](http://www.php-fig.org/psr/psr-0/)
- [PSR-1](http://www.php-fig.org/psr/psr-1/)
- [PSR-2](http://www.php-fig.org/psr/psr-2/)
- [PSR-3](http://www.php-fig.org/psr/psr-3/)
- [PSR-4](http://www.php-fig.org/psr/psr-4/)

Поддержка этих стандартов есть во всех современных IDE по-умолчанию.
Следование PSR-стандартам дает использовать огромное количество современных качественных решений,
написанные open-source сообществом.
Перед написанием какой-либо библиотеки, настоятельно рекомендуем
поискать качественное решение на (https://packagist.org/) и если такое решение существует,
интегрировать его в модуль.

Кроме принятых PSR-стандартов, существуют некоторые соглашения, описанные ниже.

Соглашения по структуре кода (Code Structure)
-------------

- Определяйте один класс в одном файле, как этого требует [PSR-0](http://www.php-fig.org/psr/psr-0/);

- Все файлы с кодом должны быть в UTF-8 без BOM сигнатуры;

####Правила написания ключевых слов PHP, и некоторых специальных типов данных:

- все ключевые слова ДОЛЖНЫ быть в нижнем регистре (while, for, false, true, ...);
- используйте короткий синтаксис определения массивов. $b = [1, 2, 3];
- null ДОЛЖЕН быть в нижнем регистре;

####PHP-tags:

- PHP-код ДОЛЖЕН начинаться тэгом "<?php", до этого тэга НЕ ДОЛЖНО быть ни каких пробелов, переносов строк, BOM-сигнатуры;
- запрещено использовать короткий открывающий тег <?;
- в шаблонах пользуйтесь коротким синтаксисом для вывода переменных <?= $boo->a ?>
- файлы с классами НЕ ДОЛЖНЫ использовать закрывающий тэг ?>;

####Пространства имен (namespace):

- каждый класс должен принадлежать какому-либо namespace;
- запрещено засорять глобальную область видимости;
- в одном файле может быть объявлен только один namespace;
- если декларация требует обращения к сущностям из другого неймспейса (даже в PHPDoc-комментариях),
  то такие сущности ДОЛЖНЫ быть импортированы в неймспейс через use;
- между namespace и use ДОЛЖНА быть одна пустая строка;
- каждый use ДОЛЖЕН быть на отдельной строке;
- после последнего use, до декларации сущности ДОЛЖНА быть одна пустая строка;

####Порядок определения сущностей в классе:
- блок use для подключения трейтов;
- константы класса
- свойства класса
- статичные методы класса
- абстрактные методы класса
- методы класса

####Порядок следования методов, в зависимости от режима доступа:
- public
- protected
- private

####Вы ДОЛЖНЫ использовать пробелы в следующих случаях:
- вокруг оператора конкатенации .. Ex: $s = 'string' . $postfix;
- вокруг операторов присваивания =, +=, .= , ... Ex: public function boo($var = 'default');
- вокруг логических операторов &&, ||. Ex: if ($a == 2 && $b == 3);
- вокруг операторов эквивалентности ==, ===, !=, !==. Ex: return $a === $b;
- вокруг операторов сравнения <, >, <=, >=. Ex: $a < 5;
- вокруг двоичных операторов &, |, ^., <<, >> Ex: $z = $x | 2;
- вокруг аддитивных и мультипликативных операторов +, -, *, /, %. Ex: $a = 5 + 5;
- после if, else, for, while, do, switch, try, catch. Ex: if ($boo === true);
- после разделителя (; и ,). Ex: for ($i = 0; $i < 5; $i++) {; list($a, $b) = $c;
- после type cast. Ex: $i = (int) $i;
- перед открывающей фигурной скобкой Ex: public function boo() {, if ($a) {;
- внутри тернарного оператора. Ex: $k = $x > 5 ? 1 : 2, $x = $y ?: null;

####Вы НЕ ДОЛЖНЫ использовать пробелы в следующих случаях:
- перед и после открывающей скобкой декларации параметров метода. Ex: public function test($boo)
- вокруг оператора вызова метода. Ex: $this->test($boo);
- вокруг унарных операторов ++, --. Ex: $a++;
- внутри brackets []. Ex: $arr['boo'];
- внутри скобок инициализации массивов. Ex: $boo = [1, 2, 3];  []. Ex: $arr['boo'];
- внутри скобок групп операторов. Ex: $y = ((5 - 7) + (6 - 8)) * 10;
- внутри скобок параметров вызова метода и скобок декларации метода. Ex: $this->test($boo);
- внутри скобок в if, for, while, switch, catch; Ex: while (true)
- перед разделителем (; и ,). Ex: for ($i = 0; $i < 5; $i++) {; list($a, $b) = $c;

####Комментарии в коде:
- комментарии внутри кода, описывающие как он работает ЗАПРЕЩЕНЫ;
- если часть кода в методе требует комментирования,
скорее всего необходимо провести рефакторинг метода (например, Extract Method и описать его в PHPDoc) ;
- разрешены только управляющие комментарии, например // TODO:

####PHPDoc-аннонтции:
- каждый класс, метод, свойство, константа должен быть задокументирован в PHPDoc;
- описание метода ДОЛЖНО начинаться с Заглавной буквы и находиться в третьем лице, единственном числе. (как в документации php);
- все исключения, которые выбрасывает метод должны быть задокументированы;
- на данный момент все описание принято описывать на русском языке. Возможно, это изменится в будущем.

Соглашения по именованию (Naming Conventions)
-------------

####Используйте camelCase для:
- имен переменных;
- имен функций, методов и их аргументов Ex: public function myFirstMethod($param1, $secondParam);
- имен опций в конфигурационных массивах; $options['someOption'];

####Используйте underscore для:
- имен таблиц и колонок в БД
- имен констант

####Используйте StudlyCaps для:
- имен классов
- имен трейтов
- имен интерфейсов

####Правила именования пространств имен, классов, интерфейсов, трейтов:
- имена namespace должны быть в нижнем регистре. Ex: umicms\project;
- имена классов ДОЛЖНЫ быть указаны в StudlyCaps и не содержать никаких префиксов;
- если класс абстракный, то он должен иметь префикс Base. Ex: BaseUser;
- имена интерфейсов ДОЛЖНЫ быть указаны в StudlyCaps и начинаться с префикса "I". Ex: ICmsCollection;
- имена трейтов ДОЛЖНЫ быть указаны в StudlyCaps и начинаться с префикса "T". Ex: TLoggerAware;
- для классов-исключений вы должны испольщовать суффикс Exception. Ex: InvalidArgumentException;

####Правила именования констант класса / трейта / интерфейса:
- имена констант должны быть написаны в UPPERCASE;
- в качестве разделителя в имени нужно использовать underscore (_);

####Правила именования переменных / свойств класса / аргументов метода:
- имя переменной должно быть в camelCase. Ex: $myFirstVariable = 1;
- имя переменной ДОЛЖНО однозначно отражать ее назначение;
- имя переменной не должно вызывать сомнения в том, скалярное или объектное значение в нем содержится.
Например, если необходимо хранить в переменной идентификатор пользователя,
запрещено использовать имя переменной $user, необходимо использовать $userId;
- если приватное свойство определяется в трейте, оно должно иметь префикс trait. Ex: private $traitTranslator;
- для итерируемых переменных цикла рекомендуется использовать имена $i, $j, $k...;

####Правила именования функций / методов класса:
- имена методов должны быть в camelCase;
- имя метода не должно вызывать сомнения в том, скалярное или объектное значение он возвращает.
Например, метод getTypes() не должен возвращать список имен типов, он должен возвращать список экземпляров объектов.
Для возврата имен типов, следует назвать метод getTypeNames().
- режим доступа (private/static...) НЕ ДОЛЖЕН влиять на имя метода (Запрещено: private function __privateMethod());
- геттеры и сеттеры должны иметь префиксы get, set;
- методы, для проверки состояния должны иметь префикс is. Ex: isAllowed()


