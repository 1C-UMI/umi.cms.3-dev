Правила разработки для Core Team
=============

Документ содержит правила публикации кода в репозиторий UMI.CMS и должен соблюдаться всеми членами команды.
Разработка ведется под контролем версий с использованием Git, а так же под управлением Youtrack.

===Именование веток===
При именовании веток существует следующая нотация:
- feature/* : Рождается от dev-а. Вливается в dev. Служит для разработки нового функционала (хоть сколько-нибудь сложного). В master вливается вместе с кучей других фичей для "релиза".
- bugfix/* : Рождается от dev-а. Вливается в dev. Служит для фиксов, занимающих много времени.
- release/* : Рождается от dev-а. Вливается в dev. Создает новый релизный тэг 3-го уровня. Служит для подготовки релиза и переноса функционала из dev-а на продакшан.
- _* : Рождается от веток, отличных от dev и master. Вливается в ту ветку, от которой был рожден. Служит для решения подзадач для большой задачи, для декомпозиции больших задач на маленькие и для всех прочих целей.
- _bugfix_*: Рождается от веток, отличных от dev и master. Вливается в ту ветку, от которой был рожден. Служит для фиксов, занимающих много времени, для большой задачи.

Кроме этого, если необходимо что-либо быстро зафиксить в любой ветке, при этом ничего не делание или багфиксовая ветка - это хуже, чем простой прямой коммит, то разрешается таким образом коммитить. В описании коммита обязательно должно быть [hotfix] .

===Версионирование===

Каждый коммит в master помечается цифровым тэгом, состоящим из 3-х или 4-х цифр: 3.X.Y.Z

Четвертая цифра (Z) - это багофиксовая версия. Она меняется при вливании в master хотфиксов и багфиксов. Инкрементируется в рамках текущей версии. Как только выкладывется релиз (меняется текущая версия) - счетчик сбрасывется.
Третья цифра (Y) - это минорная версия. Она меняется при каждом релизе маленькой функциональности. При релизе ставится тэг, состоящий из двух цифр. Если поменялась мажорная версия, то текущая версия выставляется в 0.
Вторая цифра (X) - это мажорная версия. Она меняется только при релизе крупного функционала. Также в рамках мажорных релизах есть возможность делать некоторые методы deprecated.
Первая цифра (S) - это супермажорная версия. Она меняется только при удалении deprecated методов и при крупном релизе.

===Соглашение по комментариям к пулреквестам===
- Названием пулреквеста должна быть задача из ютрака. Пример: cms-897 Комментарии для новостей
- В комментарии к пулреквесту кидаем прямую ссылку на задачу.

При коммите релиза комментарием служит changelog, собранный по пулреквестам в dev с момента предыдущего релиза.


В процессе разработки действуют следующие принципы:
- в dev-ветку допускаются только merge-коммиты feature-бранчей, а так же маленькие багофиксы (на 10-15 минут времени),
которые нужны всем и не ломают dev.
Если багофикс более-менее сложный и есть вероятность поломать dev, необходимо поставить задачу в Youtrack и
выделить под него отдельную ветку и обязательно покрыть баг тестами.
- разработчик создает новую ветку, указывает ее в карточке задачи Youtrack, пишет в своей ветку код, коммитит, пушит.
Перед созданием ветки нужно убедиться, что в своем репозитории находится актуальные версии dev и master;
- Каждый коммит обязательно сопровождается комментарием. Удобно, когда в комментарии также указывается ссылка на
карточку задачи в youtrack. Коммиты должны быть частые и, по возможноти, семантично разделенные.
Т.е. не надо тратить много времени и коммитить каждую измененную строчку,
но и всю большую задачу в один МЕГАКОММИТ тоже не надо заносить;
- Пушить надо хотя бы раз в день.

Каждый комментарий к мерж-коммиту в dev или master строится так: название_задачи_из_youtrack_с_номером (ссылка_на_карточку_задачи).
